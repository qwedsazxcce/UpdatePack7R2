name: é€ä¸ªä¸‹è½½ä¸Šä¼ Win7å·¥å…·åˆ°Misc Releasesï¼ˆæœ€ç»ˆç¨³å®šç‰ˆï¼‰

on:
  workflow_dispatch:  # æ‰‹åŠ¨è§¦å‘

jobs:
  download-upload-one-by-one:
    runs-on: windows-latest
    timeout-minutes: 180
    steps:
      # æ­¥éª¤1ï¼šæ£€å‡ºä»“åº“ï¼ˆå¿…é€‰ï¼‰
      - name: æ£€å‡ºä»£ç ä»“åº“
        uses: actions/checkout@v4
        with:
          fetch-depth: 1

      # ===================== é€ä¸ªå¤„ç†æ–‡ä»¶ï¼ˆæ”¹ç”¨curl.exeï¼Œæ— PowerShellå‚æ•°å‘ï¼‰ =====================
      # ç¬¬1ä¸ªæ–‡ä»¶ï¼šUpdatePack7R2-26.1.15.exe
      - name: ä¸‹è½½æ–‡ä»¶1 - UpdatePack7R2-26.1.15.exe
        shell: cmd  # ç”¨cmdæ‰§è¡Œcurlï¼Œæ›´ç¨³å®š
        id: download_1
        run: |
          @echo off
          set "filename=UpdatePack7R2-26.1.15.exe"
          set "url=https://github.com/yuanpeirong/UpdatePack7R2/releases/download/UpdatePack7R2/UpdatePack7R2-26.1.15.exe"
          
          echo === å¼€å§‹ä¸‹è½½æ–‡ä»¶1ï¼š%filename% ===
          :: Windowsè‡ªå¸¦curlï¼Œå‚æ•°é€‚é…æ‰€æœ‰é“¾æ¥ï¼ˆGitHub/GitLabé€šç”¨ï¼‰
          curl.exe -L -o "%filename%" ^
            -A "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" ^
            --retry 10 ^
            --retry-delay 15 ^
            --max-time 3600 ^
            "%url%"

          :: æ ¡éªŒæ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”éç©º
          if exist "%filename%" (
            for %%f in ("%filename%") do set "filesize=%%~zf"
            if !filesize! gtr 0 (
              echo âœ… æ–‡ä»¶1ä¸‹è½½æˆåŠŸï¼Œå¤§å°ï¼š!filesize! å­—èŠ‚
              echo FILE1_NAME=%filename% >> %GITHUB_ENV%
            ) else (
              echo âŒ æ–‡ä»¶1ä¸‹è½½å¤±è´¥ï¼šæ–‡ä»¶ä¸ºç©ºï¼
              exit 1
            )
          ) else (
            echo âŒ æ–‡ä»¶1ä¸‹è½½å¤±è´¥ï¼šæ–‡ä»¶ä¸å­˜åœ¨ï¼
            exit 1
          )

      - name: ä¸Šä¼ æ–‡ä»¶1åˆ°Misc Releases
        uses: softprops/action-gh-release@v1
        with:
          tag_name: Misc
          overwrite: true
          files: ${{ env.FILE1_NAME }}
          draft: false
          prerelease: false
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          GH_RELEASE_UPLOAD_CONCURRENCY: 1

      # ç¬¬2ä¸ªæ–‡ä»¶ï¼šdotNetFx48_20251014_x64.WA
      - name: ä¸‹è½½æ–‡ä»¶2 - dotNetFx48_20251014_x64.WA
        shell: cmd
        id: download_2
        run: |
          @echo off
          set "filename=dotNetFx48_20251014_x64.WA"
          set "url=https://github.com/abbodi1406/dotNetFx4xW7A/releases/download/25.10.14/dotNetFx48_20251014_x64.WA"
          
          echo === å¼€å§‹ä¸‹è½½æ–‡ä»¶2ï¼š%filename% ===
          curl.exe -L -o "%filename%" ^
            -A "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" ^
            --retry 10 ^
            --retry-delay 15 ^
            --max-time 3600 ^
            "%url%"

          if exist "%filename%" (
            for %%f in ("%filename%") do set "filesize=%%~zf"
            if !filesize! gtr 0 (
              echo âœ… æ–‡ä»¶2ä¸‹è½½æˆåŠŸï¼Œå¤§å°ï¼š!filesize! å­—èŠ‚
              echo FILE2_NAME=%filename% >> %GITHUB_ENV%
            ) else (
              echo âŒ æ–‡ä»¶2ä¸‹è½½å¤±è´¥ï¼šæ–‡ä»¶ä¸ºç©ºï¼
              exit 1
            )
          ) else (
            echo âŒ æ–‡ä»¶2ä¸‹è½½å¤±è´¥ï¼šæ–‡ä»¶ä¸å­˜åœ¨ï¼
            exit 1
          )

      - name: ä¸Šä¼ æ–‡ä»¶2åˆ°Misc Releases
        uses: softprops/action-gh-release@v1
        with:
          tag_name: Misc
          overwrite: true
          files: ${{ env.FILE2_NAME }}
          draft: false
          prerelease: false
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          GH_RELEASE_UPLOAD_CONCURRENCY: 1

      # ç¬¬3ä¸ªæ–‡ä»¶ï¼šdotNetFx48_20250909_x86.WA
      - name: ä¸‹è½½æ–‡ä»¶3 - dotNetFx48_20250909_x86.WA
        shell: cmd
        id: download_3
        run: |
          @echo off
          set "filename=dotNetFx48_20250909_x86.WA"
          set "url=https://github.com/abbodi1406/dotNetFx4xW7A/releases/download/25.09.09/dotNetFx48_20250909_x86.WA"
          
          echo === å¼€å§‹ä¸‹è½½æ–‡ä»¶3ï¼š%filename% ===
          curl.exe -L -o "%filename%" ^
            -A "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" ^
            --retry 10 ^
            --retry-delay 15 ^
            --max-time 3600 ^
            "%url%"

          if exist "%filename%" (
            for %%f in ("%filename%") do set "filesize=%%~zf"
            if !filesize! gtr 0 (
              echo âœ… æ–‡ä»¶3ä¸‹è½½æˆåŠŸï¼Œå¤§å°ï¼š!filesize! å­—èŠ‚
              echo FILE3_NAME=%filename% >> %GITHUB_ENV%
            ) else (
              echo âŒ æ–‡ä»¶3ä¸‹è½½å¤±è´¥ï¼šæ–‡ä»¶ä¸ºç©ºï¼
              exit 1
            )
          ) else (
            echo âŒ æ–‡ä»¶3ä¸‹è½½å¤±è´¥ï¼šæ–‡ä»¶ä¸å­˜åœ¨ï¼
            exit 1
          )

      - name: ä¸Šä¼ æ–‡ä»¶3åˆ°Misc Releases
        uses: softprops/action-gh-release@v1
        with:
          tag_name: Misc
          overwrite: true
          files: ${{ env.FILE3_NAME }}
          draft: false
          prerelease: false
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          GH_RELEASE_UPLOAD_CONCURRENCY: 1

      # ç¬¬4ä¸ªæ–‡ä»¶ï¼švcredist_x64_Win7_20250708.WAï¼ˆå½»åº•é‡æ„ï¼Œæ— PowerShellå‚æ•°ï¼‰
      - name: ä¸‹è½½æ–‡ä»¶4 - vcredist_x64_Win7_20250708.WA
        shell: cmd
        id: download_4
        run: |
          @echo off
          set "filename=vcredist_x64_Win7_20250708.WA"
          set "url=https://gitlab.com/-/project/11037551/uploads/8899c68cf5b5bfc7da7f04b73afa9f58/vcredist_x64_Win7_20250708.WA"
          
          echo === å¼€å§‹ä¸‹è½½æ–‡ä»¶4ï¼š%filename% ===
          :: curlè‡ªå¸¦-Lå‚æ•°å¤„ç†é‡å®šå‘ï¼Œæ— éœ€é¢å¤–PowerShellå‚æ•°ï¼Œå½»åº•è§„é¿å…¼å®¹é—®é¢˜
          curl.exe -L -o "%filename%" ^
            -A "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" ^
            --retry 10 ^
            --retry-delay 15 ^
            --max-time 3600 ^
            "%url%"

          if exist "%filename%" (
            for %%f in ("%filename%") do set "filesize=%%~zf"
            if !filesize! gtr 0 (
              echo âœ… æ–‡ä»¶4ä¸‹è½½æˆåŠŸï¼Œå¤§å°ï¼š!filesize! å­—èŠ‚
              echo FILE4_NAME=%filename% >> %GITHUB_ENV%
            ) else (
              echo âŒ æ–‡ä»¶4ä¸‹è½½å¤±è´¥ï¼šæ–‡ä»¶ä¸ºç©ºï¼
              exit 1
            )
          ) else (
            echo âŒ æ–‡ä»¶4ä¸‹è½½å¤±è´¥ï¼šæ–‡ä»¶ä¸å­˜åœ¨ï¼
            exit 1
          )

      - name: ä¸Šä¼ æ–‡ä»¶4åˆ°Misc Releases
        uses: softprops/action-gh-release@v1
        with:
          tag_name: Misc
          overwrite: true
          files: ${{ env.FILE4_NAME }}
          draft: false
          prerelease: false
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          GH_RELEASE_UPLOAD_CONCURRENCY: 1

      # ç¬¬5ä¸ªæ–‡ä»¶ï¼švcredist_x86_Win7_20250708_r.WA
      - name: ä¸‹è½½æ–‡ä»¶5 - vcredist_x86_Win7_20250708_r.WA
        shell: cmd
        id: download_5
        run: |
          @echo off
          set "filename=vcredist_x86_Win7_20250708_r.WA"
          set "url=https://gitlab.com/-/project/11037551/uploads/49d56348397669befad302f58070ab2f/vcredist_x86_Win7_20250708_r.WA"
          
          echo === å¼€å§‹ä¸‹è½½æ–‡ä»¶5ï¼š%filename% ===
          curl.exe -L -o "%filename%" ^
            -A "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" ^
            --retry 10 ^
            --retry-delay 15 ^
            --max-time 3600 ^
            "%url%"

          if exist "%filename%" (
            for %%f in ("%filename%") do set "filesize=%%~zf"
            if !filesize! gtr 0 (
              echo âœ… æ–‡ä»¶5ä¸‹è½½æˆåŠŸï¼Œå¤§å°ï¼š!filesize! å­—èŠ‚
              echo FILE5_NAME=%filename% >> %GITHUB_ENV%
            ) else (
              echo âŒ æ–‡ä»¶5ä¸‹è½½å¤±è´¥ï¼šæ–‡ä»¶ä¸ºç©ºï¼
              exit 1
            )
          ) else (
            echo âŒ æ–‡ä»¶5ä¸‹è½½å¤±è´¥ï¼šæ–‡ä»¶ä¸å­˜åœ¨ï¼
            exit 1
          )

      - name: ä¸Šä¼ æ–‡ä»¶5åˆ°Misc Releases
        uses: softprops/action-gh-release@v1
        with:
          tag_name: Misc
          overwrite: true
          files: ${{ env.FILE5_NAME }}
          draft: false
          prerelease: false
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          GH_RELEASE_UPLOAD_CONCURRENCY: 1

      # ç¬¬6ä¸ªæ–‡ä»¶ï¼švcredist_x64_2022_WinAll_14.44.35211.WA
      - name: ä¸‹è½½æ–‡ä»¶6 - vcredist_x64_2022_WinAll_14.44.35211.WA
        shell: cmd
        id: download_6
        run: |
          @echo off
          set "filename=vcredist_x64_2022_WinAll_14.44.35211.WA"
          set "url=https://gitlab.com/-/project/11037551/uploads/ce26d073600eb68db902bc12946d42e7/vcredist_x64_2022_WinAll_14.44.35211.WA"
          
          echo === å¼€å§‹ä¸‹è½½æ–‡ä»¶6ï¼š%filename% ===
          curl.exe -L -o "%filename%" ^
            -A "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" ^
            --retry 10 ^
            --retry-delay 15 ^
            --max-time 3600 ^
            "%url%"

          if exist "%filename%" (
            for %%f in ("%filename%") do set "filesize=%%~zf"
            if !filesize! gtr 0 (
              echo âœ… æ–‡ä»¶6ä¸‹è½½æˆåŠŸï¼Œå¤§å°ï¼š!filesize! å­—èŠ‚
              echo FILE6_NAME=%filename% >> %GITHUB_ENV%
            ) else (
              echo âŒ æ–‡ä»¶6ä¸‹è½½å¤±è´¥ï¼šæ–‡ä»¶ä¸ºç©ºï¼
              exit 1
            )
          ) else (
            echo âŒ æ–‡ä»¶6ä¸‹è½½å¤±è´¥ï¼šæ–‡ä»¶ä¸å­˜åœ¨ï¼
            exit 1
          )

      - name: ä¸Šä¼ æ–‡ä»¶6åˆ°Misc Releases
        uses: softprops/action-gh-release@v1
        with:
          tag_name: Misc
          overwrite: true
          files: ${{ env.FILE6_NAME }}
          draft: false
          prerelease: false
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          GH_RELEASE_UPLOAD_CONCURRENCY: 1

      # ç¬¬7ä¸ªæ–‡ä»¶ï¼švcredist_x86_2022_WinAll_14.44.35211_r.WA
      - name: ä¸‹è½½æ–‡ä»¶7 - vcredist_x86_2022_WinAll_14.44.35211_r.WA
        shell: cmd
        id: download_7
        run: |
          @echo off
          set "filename=vcredist_x86_2022_WinAll_14.44.35211_r.WA"
          set "url=https://gitlab.com/-/project/11037551/uploads/16a7925f42634ef7232d7d9cc122034a/vcredist_x86_2022_WinAll_14.44.35211_r.WA"
          
          echo === å¼€å§‹ä¸‹è½½æ–‡ä»¶7ï¼š%filename% ===
          curl.exe -L -o "%filename%" ^
            -A "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" ^
            --retry 10 ^
            --retry-delay 15 ^
            --max-time 3600 ^
            "%url%"

          if exist "%filename%" (
            for %%f in ("%filename%") do set "filesize=%%~zf"
            if !filesize! gtr 0 (
              echo âœ… æ–‡ä»¶7ä¸‹è½½æˆåŠŸï¼Œå¤§å°ï¼š!filesize! å­—èŠ‚
              echo FILE7_NAME=%filename% >> %GITHUB_ENV%
            ) else (
              echo âŒ æ–‡ä»¶7ä¸‹è½½å¤±è´¥ï¼šæ–‡ä»¶ä¸ºç©ºï¼
              exit 1
            )
          ) else (
            echo âŒ æ–‡ä»¶7ä¸‹è½½å¤±è´¥ï¼šæ–‡ä»¶ä¸å­˜åœ¨ï¼
            exit 1
          )

      - name: ä¸Šä¼ æ–‡ä»¶7åˆ°Misc Releases
        uses: softprops/action-gh-release@v1
        with:
          tag_name: Misc
          overwrite: true
          files: ${{ env.FILE7_NAME }}
          draft: false
          prerelease: false
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          GH_RELEASE_UPLOAD_CONCURRENCY: 1

      # æ­¥éª¤2ï¼šå…¨æµç¨‹å®Œæˆç¡®è®¤
      - name: æ‰€æœ‰æ–‡ä»¶å¤„ç†å®Œæˆ
        shell: cmd
        run: |
          @echo off
          echo ğŸ‰ æ‰€æœ‰7ä¸ªæ–‡ä»¶å·²å®Œæˆã€Œä¸‹è½½â†’ä¸Šä¼ ã€å…¨æµç¨‹ï¼
          echo === æœ€ç»ˆæ–‡ä»¶åˆ—è¡¨ ===
          dir *.exe *.WA
